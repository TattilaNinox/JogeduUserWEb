================================================================================
MEM√ìRIA√ÅLLOM√ÅS MEGJELEN√çT√âSE - K√âSZEN HASZN√ÅLHAT√ì P√âLDA
K√ñZVETLEN√úL M√ÅSOLHAT√ì K√ìD - FLUTTER WEB
================================================================================

Ez a f√°jl tartalmazza a TELJES, K√âSZEN HASZN√ÅLHAT√ì k√≥dot, amit k√∂zvetlen√ºl
be lehet m√°solni a m√°sik Flutter webalkalmaz√°sba. Minden sz√ºks√©ges r√©sz benne van.

================================================================================
1. SZ√úKS√âGES IMPORT-OK
================================================================================

M√°sold be ezeket az import-okat a f√°jl tetej√©re:

import 'package:flutter/material.dart';
import 'package:web/web.dart' as web;
import 'package:flutter/foundation.dart' show kIsWeb;
import 'dart:ui_web' as ui_web;

================================================================================
2. TELJES MET√ìDUS - M√ÅSOLHAT√ì K√ìD
================================================================================

M√°sold be ezt a teljes met√≥dust a State oszt√°lyodba:

void _showAllomasPreview(
  String cim,           // √Ållom√°s c√≠me
  String kulcsszo,      // Kulcssz√≥ (lehet √ºres string)
  String tartalom,      // HTML tartalom
  {int? sorszam}        // √Ållom√°s sorsz√°ma (opcion√°lis)
) {
  // FONTOS: Ellen≈ërizz√ºk, hogy web platformon vagyunk-e!
  if (!kIsWeb) {
    // Ha nem web platform, egyszer≈± sz√∂veges megjelen√≠t√©s
    showDialog(
      context: context,
      builder: (context) => Dialog(
        child: Container(
          width: MediaQuery.of(context).size.width * 0.8,
          height: MediaQuery.of(context).size.height * 0.8,
          padding: const EdgeInsets.all(16.0),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Row(
                mainAxisAlignment: MainAxisAlignment.spaceBetween,
                children: [
                  Expanded(
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        Text(
                          cim,
                          style: const TextStyle(
                            fontSize: 18,
                            fontWeight: FontWeight.bold,
                          ),
                        ),
                        if (kulcsszo.isNotEmpty)
                          Padding(
                            padding: const EdgeInsets.only(top: 4.0),
                            child: Text(
                              'Kulcssz√≥: $kulcsszo',
                              style: TextStyle(
                                fontSize: 14,
                                fontStyle: FontStyle.italic,
                                color: Colors.grey[600],
                              ),
                            ),
                          ),
                      ],
                    ),
                  ),
                  IconButton(
                    icon: const Icon(Icons.close),
                    onPressed: () => Navigator.of(context).pop(),
                  ),
                ],
              ),
              const Divider(),
              Expanded(
                child: SingleChildScrollView(
                  child: Text(
                    tartalom,
                    style: const TextStyle(
                      fontSize: 13,
                      height: 1.5,
                    ),
                  ),
                ),
              ),
            ],
          ),
        ),
      ),
    );
    return; // FONTOS: Kil√©p√ºnk, ha nem web platform!
  }

  // ============================================================================
  // WEB PLATFORM: HTML MEGJELEN√çT√âS IFRAME-MEL
  // ============================================================================

  // FONTOS: Minden alkalommal egyedi view ID-t kell gener√°lni!
  final previewViewId =
      'allomas-preview-iframe-${DateTime.now().millisecondsSinceEpoch}';

  // Iframe elem l√©trehoz√°sa
  final previewIframeElement = web.HTMLIFrameElement()
    ..style.width = '100%'
    ..style.height = '100%'
    ..style.border = 'none';

  // Badge oszt√°ly sz√°m√≠t√°sa (ciklikus sz√≠nez√©s 1-11)
  String badgeClass = '';
  if (sorszam != null && sorszam > 0) {
    final badgeNumber = sorszam > 11 ? ((sorszam - 1) % 11) + 1 : sorszam;
    badgeClass = 'badge-$badgeNumber';
  }

  // Teljes HTML dokumentum l√©trehoz√°sa - PONTOSAN EZT A CSS-T HASZN√ÅLD!
  final fullHtml = '''
<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; font-size: 14px; line-height: 1.6; text-align: justify; hyphens: auto; padding: 2em; word-wrap: break-word; max-width: 900px; margin: 0 auto; color: #333; }
    h1 { font-size: 1.6em; text-align: center; border-bottom: 2px solid #333; padding-bottom: 0.5em; margin-bottom: 1.5em; }
    h2 { font-size: 1.3em; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-top: 2em; color: #2c3e50; }
    h3 { font-size: 1.1em; margin-top: 1.2em; font-weight: 600; }
    p { margin-bottom: 0.8em; }
    ul, ol { padding-left: 20px; margin-bottom: 1em; }
    li { margin-bottom: 0.5em; }
    
    /* C√çMK√âK √âS JELV√âNYEK */
    .allomas-badge { display: inline-block; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.8em; margin-right: 10px; vertical-align: middle; font-weight: bold; min-width: 20px; text-align: center; }
    /* EGYEDI SZ√çNEK AZ √ÅLLOM√ÅSOKHOZ */
    .badge-1 { background-color: #D32F2F; } .badge-2 { background-color: #1976D2; } .badge-3 { background-color: #388E3C; }
    .badge-4 { background-color: #E64A19; } .badge-5 { background-color: #7B1FA2; } .badge-6 { background-color: #0097A7; }
    .badge-7 { background-color: #C2185B; } .badge-8 { background-color: #5D4037; } .badge-9 { background-color: #FBC02D; color: #333; }
    .badge-10 { background-color: #455A64; } .badge-11 { background-color: #303F9F; }

    .kulcsszo { font-style: italic; color: #555; margin-bottom: 1em; display: block; border-left: 3px solid #ccc; padding-left: 10px; }
    
    /* SZ√ñVEG KIEMEL√âSEK */
    .szin-piros { color: #D32F2F; font-weight: bold; }
    .szin-zold { color: #388E3C; font-weight: bold; }
    .szin-kek { color: #1976D2; font-weight: bold; }
    .hatter-sarga { background-color: #FFF59D; padding: 0.1em 0.3em; border-radius: 3px; }
    strong { font-weight: bold; }
    
    /* JOGSZAB√ÅLY DOBOZ ST√çLUS */
    .jogszabaly-doboz { background-color: #f0f4f8; border-left: 4px solid #2c3e50; padding: 10px 15px; margin: 15px 0; font-style: italic; font-size: 0.95em; color: #444; }
    .jogszabaly-cimke { font-weight: bold; font-style: normal; display: block; margin-bottom: 5px; color: #2c3e50; font-size: 0.9em; text-transform: uppercase; }
    
    @media screen and (max-width: 768px) { body { padding: 1em; } }
  </style>
</head>
<body>
  <h2>${sorszam != null && sorszam > 0 ? '<span class="allomas-badge $badgeClass">$sorszam.</span>' : ''}$cim</h2>
  ${kulcsszo.isNotEmpty ? '<span class="kulcsszo">Kulcssz√≥: $kulcsszo</span>' : ''}
  $tartalom
</body>
</html>
''';

  // FONTOS: Az iframe src-j√©t data URI form√°tumban kell be√°ll√≠tani!
  // FONTOS: A HTML tartalmat MINDIG Uri.encodeComponent()-tel kell k√≥dolni!
  previewIframeElement.src =
      'data:text/html;charset=utf-8,${Uri.encodeComponent(fullHtml)}';

  // FONTOS: Platform view regisztr√°l√°sa MINDIG az iframe src be√°ll√≠t√°sa UT√ÅN!
  // ignore: undefined_prefixed_name
  ui_web.platformViewRegistry.registerViewFactory(
    previewViewId,
    (int viewId) => previewIframeElement,
  );

  // Dialog megjelen√≠t√©se
  showDialog(
    context: context,
    builder: (context) => Dialog(
      child: Container(
        width: MediaQuery.of(context).size.width * 0.85,
        height: MediaQuery.of(context).size.height * 0.85,
        padding: const EdgeInsets.all(16.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                Expanded(
                  child: Text(
                    cim,
                    style: const TextStyle(
                      fontSize: 18,
                      fontWeight: FontWeight.bold,
                    ),
                  ),
                ),
                IconButton(
                  icon: const Icon(Icons.close),
                  onPressed: () => Navigator.of(context).pop(),
                ),
              ],
            ),
            const Divider(),
            Expanded(
              // FONTOS: HtmlElementView haszn√°lata a view ID-val!
              child: HtmlElementView(viewType: previewViewId),
            ),
          ],
        ),
      ),
    ),
  );
}

================================================================================
3. HASZN√ÅLATI P√âLDA
================================================================================

P√©lda h√≠v√°s egy ListTile onTap esem√©nyben vagy gombon:

// Firestore dokumentumb√≥l kiolvasott adatokkal:
final cim = allomasData['cim'] as String? ?? 'N√©vtelen √°llom√°s';
final kulcsszo = allomasData['kulcsszo'] as String? ?? '';
final tartalom = allomasData['tartalom'] as String? ?? '';
final sorszam = allomasData['sorszam'] as int?;

// Met√≥dus h√≠v√°sa:
_showAllomasPreview(cim, kulcsszo, tartalom, sorszam: sorszam);

VAGY egyszer≈±bb p√©lda:

_showAllomasPreview(
  'A szem√©lyis√©gi jogok alapjai',
  'szem√©lyis√©gi jogok',
  '<p>A <span class="szin-kek">szem√©lyis√©gi jogok</span> az emberi m√©lt√≥s√°gb√≥l erednek.</p>',
  sorszam: 1,
);

================================================================================
4. PUBSPEC.YAML F√úGG≈êS√âGEK
================================================================================

Ellen≈ërizd, hogy a pubspec.yaml f√°jlban szerepelnek-e ezek a f√ºgg≈ës√©gek:

dependencies:
  flutter:
    sdk: flutter
  # ... egy√©b f√ºgg≈ës√©gek

A `web` package a Flutter SDK r√©sze, nem kell k√ºl√∂n hozz√°adni.
A `dart:ui_web` is a Flutter SDK r√©sze.

Ha hib√°t kapsz, hogy nincs `web` package, akkor:
1. Ellen≈ërizd, hogy Flutter Web-et haszn√°lsz (flutter run -d chrome)
2. Friss√≠tsd a Flutter SDK-t: flutter upgrade

================================================================================
5. GYAKORI HIBAOK √âS MEGOLD√ÅSAIK
================================================================================

HIBA: "The name 'HtmlElementView' isn't defined"
MEGOLD√ÅS: Import√°ld: import 'package:flutter/widgets.dart';

HIBA: "The name 'web' isn't defined"
MEGOLD√ÅS: Import√°ld: import 'package:web/web.dart' as web;

HIBA: "The name 'ui_web' isn't defined"
MEGOLD√ÅS: Import√°ld: import 'dart:ui_web' as ui_web;

HIBA: "The name 'kIsWeb' isn't defined"
MEGOLD√ÅS: Import√°ld: import 'package:flutter/foundation.dart' show kIsWeb;

HIBA: Az iframe √ºres marad
MEGOLD√ÅS: 
1. Ellen≈ërizd, hogy a registerViewFactory-t AZ iframe src be√°ll√≠t√°sa UT√ÅN h√≠vod-e meg
2. Ellen≈ërizd, hogy Uri.encodeComponent()-et haszn√°lod-e
3. Ellen≈ërizd a b√∂ng√©sz≈ë konzolt (F12) - vannak-e hib√°k?

HIBA: A CSS nem m≈±k√∂dik
MEGOLD√ÅS:
1. Ellen≈ërizd, hogy teljes HTML dokumentumot hozol-e l√©tre (<!DOCTYPE html>...)
2. Ellen≈ërizd, hogy a CSS pontosan ugyanaz, mint a fenti p√©ld√°ban
3. Ellen≈ërizd, hogy nincs-e m√°s CSS, ami fel√ºl√≠rja ezeket

HIBA: A badge sz√≠ne rossz
MEGOLD√ÅS:
1. Ellen≈ërizd a badge oszt√°ly sz√°m√≠t√°s√°t: sorszam > 11 ? ((sorszam - 1) % 11) + 1 : sorszam
2. Ellen≈ërizd, hogy a badge CSS oszt√°lyok mind a 11 sz√≠n defini√°lva vannak-e

================================================================================
6. TELJES P√âLDA F√ÅJL (OPCION√ÅLIS)
================================================================================

Ha szeretn√©d, hogy egy k√ºl√∂n f√°jlban legyen, akkor hozz l√©tre egy √∫j f√°jlt:

lib/widgets/allomas_preview_dialog.dart

√âs m√°sold be ezt:

import 'package:flutter/material.dart';
import 'package:web/web.dart' as web;
import 'package:flutter/foundation.dart' show kIsWeb;
import 'dart:ui_web' as ui_web;

class AllomasPreviewDialog {
  static void show(
    BuildContext context, {
    required String cim,
    required String kulcsszo,
    required String tartalom,
    int? sorszam,
  }) {
    // Itt m√°sold be a teljes _showAllomasPreview met√≥dus k√≥dj√°t,
    // de a 'context' param√©tert vedd ki, mert m√°r a show met√≥dusban van
  }
}

Akkor √≠gy h√≠vod meg:

AllomasPreviewDialog.show(
  context,
  cim: 'C√≠m',
  kulcsszo: 'kulcssz√≥',
  tartalom: '<p>Tartalom</p>',
  sorszam: 1,
);

================================================================================
7. ELLEN≈êRZ√âSI LISTA
================================================================================

Miel≈ëtt futtatod, ellen≈ërizd:

[‚úì] Van-e import√°lva: 'package:flutter/material.dart';
[‚úì] Van-e import√°lva: 'package:web/web.dart' as web;
[‚úì] Van-e import√°lva: 'package:flutter/foundation.dart' show kIsWeb;
[‚úì] Van-e import√°lva: 'dart:ui_web' as ui_web;
[‚úì] A met√≥dus a State oszt√°lyodban van-e?
[‚úì] A context el√©rhet≈ë-e a met√≥dusban?
[‚úì] A CSS pontosan ugyanaz, mint a fenti p√©ld√°ban?
[‚úì] A badge oszt√°ly sz√°m√≠t√°sa helyes-e?

================================================================================
8. TESZTEL√âS
================================================================================

1. Futtasd az alkalmaz√°st: flutter run -d chrome
2. H√≠vd meg a met√≥dust egy gombra kattintva
3. Ellen≈ërizd, hogy megjelenik-e a dialog
4. Ellen≈ërizd, hogy az iframe bet√∂lt≈ëdik-e
5. Ellen≈ërizd, hogy a CSS st√≠lusok helyesen m≈±k√∂dnek-e
6. Ellen≈ërizd, hogy a badge sz√≠ne helyes-e

Ha minden m≈±k√∂dik, akkor k√©sz vagy! üéâ

================================================================================
V√âGE
================================================================================

Ha m√©g mindig nem m≈±k√∂dik, k√ºldd el a pontos hiba√ºzenetet, √©s seg√≠tek!

